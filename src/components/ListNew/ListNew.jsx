//@author: beto0607
//generated by create_container

import React from "react";
import styles from "./ListNew.module.scss";

class ListNew extends React.Component {
    constructor(props) {
        super(props);
        this.url = `${props.base_url}users/${localStorage.getItem(
            "user_id"
        )}/lists`;
        this.handleSubmit = this.handleSubmit.bind(this);
        //this.authorization_header = new Headers({'Authorization': `Basic ${this.state.user_token}`});
    }
    handleSubmit(e) {
        e.preventDefault();
        let formData = new FormData(e.target);
        const title = formData.get("title");
        let data = {
            title: title
        };
        const due_date = formData.get("due_date");
        if (due_date) {
            data["due_date"] = due_date;
        }
        const description = formData.get("description");
        if (description) {
            data["due_date"] = description;
        }
        console.log(JSON.stringify({ list: data }));
        fetch(this.url, {
            method: "POST",
            headers: this.props.authorization_header,
            body: JSON.stringify({ list: data })
        })
            .then(response => {
                console.log(response);
                return response.json();
            })
            .then(data => {
                console.log(data);
                this.props.listAdded(data);
            });
    }
    render() {
        return (
            <div className={styles["add-list-container"]}>
                <form onSubmit={this.handleSubmit}>
                    <div className={styles["input-container"]}>
                        <h2>New List</h2>
                    </div>
                    <hr />
                    <div className={styles["input-container"]}>
                        <label htmlFor="title">Title:</label>
                        <input type="text" name="title" />
                    </div>
                    <div className={styles["input-container"]}>
                        <label htmlFor="title">Due date:</label>
                        <input
                            type="datetime-local"
                            name="due_date"
                            defaultValue={new Date().toISOString().slice(0, -1)}
                        />
                    </div>
                    <div className={styles["input-container"]}>
                        <label htmlFor="description">Description:</label>
                        <textarea name="description" />
                    </div>
                    <input type="submit" value="Create" />
                    <button onClick={this.props.close}>Cancel</button>
                </form>
            </div>
        );
    }
}
export default ListNew;
